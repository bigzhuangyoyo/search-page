<!DOCTYPE html>
<html lang="zh">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>zhelper Search Page æœç´¢ç•Œé¢ ğŸ”</title>
    <meta name="description" content="zhelper Search Page æœç´¢ç•Œé¢ ğŸ”">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7692266966719684"
        crossorigin="anonymous"></script>
    <link href="https://lf26-cdn-tos.bytecdntp.com/cdn/expire-1-M/bootstrap/5.1.3/css/bootstrap.min.css" type="text/css"
        rel="stylesheet" />
    <script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/bootstrap/5.1.3/js/bootstrap.bundle.min.js"
        type="application/javascript"></script>
    <script src="https://lf26-cdn-tos.bytecdntp.com/cdn/expire-1-M/axios/0.26.0/axios.min.js"
        type="application/javascript"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Manrope">
    <script src="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/vue/3.2.31/vue.global.min.js"
        type="application/javascript"></script>
</head>

<body>
    <div>
        <div class="container" id="app">
            <nav class="navbar navbar-expand-lg  navbar-light">
                <div class="container-fluid">
                    <b>zhelper</b>
                    <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                        data-bs-target="#navbarTogglerDemo02" aria-controls="navbarTogglerDemo02" aria-expanded="false"
                        aria-label="Toggle navigation">
                        å±•å¼€
                    </button>
                    <div class="collapse navbar-collapse pull-right" id="navbarTogglerDemo02">
                        <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                            <li class="nav-item">
                                <a class="nav-link active" aria-current="page" href="#">{{language.home}}</a>
                            </li>
                            <li class="nav-item dropdown">
                                <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" role="button"
                                    data-bs-toggle="dropdown" aria-expanded="false">
                                    {{language.changeapi}}
                                </a>
                                <ul class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                                    <li v-for="api in apis" class="dropdown-item" :key="api.id"
                                        @click="changeapi(api.url)">
                                        {{api.name}}
                                    </li>
                                </ul>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="https://github.com/zhelper-org/search-page"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><path fill="currentColor" d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5c.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34c-.46-1.16-1.11-1.47-1.11-1.47c-.91-.62.07-.6.07-.6c1 .07 1.53 1.03 1.53 1.03c.87 1.52 2.34 1.07 2.91.83c.09-.65.35-1.09.63-1.34c-2.22-.25-4.55-1.11-4.55-4.92c0-1.11.38-2 1.03-2.71c-.1-.25-.45-1.29.1-2.64c0 0 .84-.27 2.75 1.02c.79-.22 1.65-.33 2.5-.33c.85 0 1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02c.55 1.35.2 2.39.1 2.64c.65.71 1.03 1.6 1.03 2.71c0 3.82-2.34 4.66-4.57 4.91c.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2Z"/></svg></a>
                            </li>
                        </ul>
                    </div>
                </div>
            </nav>
            <div class="d-grid gap-2 d-flex justify-content-center">
                <div class="input-group">
                    <input type="text" class="form-control" placeholder="" @keyup.enter="search" v-model="keyword">
                    <button class="btn btn-primary" @click="search">æœç´¢</button>
                </div>
            </div>

            <div class="my-5 mx-auto">
                <ol class="list-group list-group-flush">
                    <a v-for="result in search_result" @click="get_detail(result.id)"
                        class=" list-group-item list-group-item-action " aria-current="true" style="text-align: left">
                        <div class="ms-2 align-items-start" style="text-align: start;">
                            <template v-if="result.info">
                                <b class="card-title">{{result.info}}</b>
                                {{language.source}}ï¼š{{result.source}}
                            </template>
                            <template v-if="result.title">
                                <b class="card-title">{{result.title}}</b>
                                {{language.author}}ï¼š{{result.author}}ï¼Œ{{language.publisher}}ï¼š{{result.publisher}}ï¼Œ{{language.year}}ï¼š{{result.year}}ï¼Œ
                                {{language.source}}ï¼š{{result.source}}
                                <br>
                                <p class="fw-light">
                                    <small>
                                        {{language.filesize}}ï¼š{{filesizeToString(result.filesize)}}ï¼ŒIDï¼š{{result.id}}ï¼ŒISBNï¼š{{result.isbn}}ï¼Œ{{language.extension}}ï¼š{{result.extension}}
                                    </small>
                                </p>
                            </template>
                        </div>
                    </a>
                </ol>
            </div>
            <nav aria-label="Page navigation example" v-if="search_result.length">
                <ul class="pagination justify-content-center">

                    <li v-if="page-1" class="page-item">
                        <a class="page-link" href="#" @click="change_page(-1)">å‰ä¸€é¡µ</a>
                    </li>
                    <li class="page-item"><a class="page-link" href="#">{{page}}</a></li>
                    <li v-if="page!= total_page" class="page-item">
                        <a class="page-link" href="#" @click="change_page(1)">åä¸€é¡µ</a>
                    </li>
                </ul>
            </nav>
            <div>
                <div v-if="is_homepage">
                    <h1>ä½¿ç”¨é¡»çŸ¥</h1>
                    <ul>
                        <li>æœ¬ç½‘é¡µæœ¬èº«ä¸å…·å¤‡ä»»ä½•æœç´¢æˆ–è€…ä¸‹è½½åŠŸèƒ½ï¼Œéœ€è¦æ­é…åˆé€‚çš„æŸ¥è¯¢æ¥å£è¿›è¡Œä½¿ç”¨</li>
                        <li>ç‚¹å‡»æœç´¢åï¼Œæœ¬ç½‘é¡µå°†å‘æŸ¥è¯¢æ¥å£å‘é€æŸ¥è¯¢ä¿¡æ¯ï¼Œæ¥å£è¿”å›ç»“æœéœ€è¦ä¸€å®šæ—¶é—´ï¼Œè¯·è€å¿ƒç­‰å¾…ï¼Œä¸è¦é‡å¤æŸ¥è¯¢</li>
                        <li>æœ¬ç½‘é¡µæ‰€æ˜¾ç¤ºçš„æŸ¥è¯¢ç»“æœå®Œå…¨å–å†³äºæ¥å£æ‰€è¿”å›çš„å†…å®¹ã€‚è¯·ä¸è¦ä½¿ç”¨æ¥å†ä¸æ˜çš„æ¥å£ï¼Œæˆ‘ä»¬ä¸å¯¹æ¥å£å†…å®¹è´Ÿè´£</li>
                        <li>é€šè¿‡æ›´æ”¹æŸ¥è¯¢æ¥å£ï¼Œå¯ä»¥å®ç°ä¸åŒå†…å®¹çš„æ··åˆæŸ¥è¯¢</li>
                        <li>æœ¬ç½‘é¡µå·²ç»å¼€æº</li>
                    </ul>
                </div>

                <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel"
                    aria-hidden="true">
                    <div class="modal-dialog modal-dialog-centered modal-lg ">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title">è¯¦ç»†ç»“æœ</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"
                                    aria-label="Close"></button>

                            </div>
                            <div class="modal-body">
                                <div id="app">
                                    <template v-if="detail.title">
                                        {{language.title}}ï¼š{{detail.title}}ï¼Œ
                                        {{language.source}}ï¼š{{detail.source}}
                                        <br>
                                        {{language.author}}ï¼š{{detail.author}}ï¼Œ{{language.publisher}}ï¼š{{detail.publisher}}ï¼Œ{{language.year}}ï¼š{{detail.year}}
                                        <br>
                                        MD5ï¼š {{detail.md5}}
                                        <br>
                                        {{language.filesize}}ï¼š{{detail.filesize}}
                                    </template>
                                    <template v-if="detail.info">
                                        {{language.info}}ï¼š{{detail.info}}ï¼Œï¼Œ
                                        {{language.source}}ï¼š{{detail.source}}
                                    </template>
                                </div>

                                <p></p>
                                <div class="modal-footer">
                                    <a v-if="detail.in_libgen" class="btn btn-secondary"
                                        :href="'http://libgendown.1kbtool.com/'+detail.md5" target="_blank">
                                        Libgen
                                    </a>
                                    <a v-if="detail.ipfs_cid !== null" class="btn btn-secondary"
                                        :href="'https://ipfs-checker.1kbtool.com/'+detail.ipfs_cid+'?filename='+detail.title+'_'+detail.author+'.'+detail.extension"
                                        target="_blank">
                                        IPFS
                                    </a>
                                    <a class="btn btn-secondary"
                                        :href="'https://rapidupload.1kbtool.com/'+detail.md5 + '#' + detail.filesize + '#' + detail.title + '_' + detail.author + '.' + detail.extension"
                                        target="_blank">
                                        ç§’ä¼ 
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <footer class="d-flex flex-wrap justify-content-between align-items-center py-3 my-4 border-top">
                    <div class="col-md-4 d-flex text-center" style="margin-left: 4px">
                        <span class="mb-3 mb-md-0 text-muted  text-center">Â© 2022 Zhelper Team</span>
                    </div>
                </footer>
            </div>

            <script async
                src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7692266966719684"
                crossorigin="anonymous"></script>
            <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-7692266966719684"
                data-ad-slot="3408254862" data-ad-format="auto" data-full-width-responsive="true"></ins>
            <script>
                (adsbygoogle = window.adsbygoogle || []).push({});
            </script>

            <script>

                function getCookie(name) {
                    // æ‹†åˆ† cookie å­—ç¬¦ä¸²
                    var cookieArr = document.cookie.split(";");

                    // å¾ªç¯éå†æ•°ç»„å…ƒç´ 
                    for (var i = 0; i < cookieArr.length; i++) {
                        var cookiePair = cookieArr[i].split("=");

                        /* åˆ é™¤ cookie åç§°å¼€å¤´çš„ç©ºç™½å¹¶å°†å…¶ä¸ç»™å®šå­—ç¬¦ä¸²è¿›è¡Œæ¯”è¾ƒ */
                        if (name == cookiePair[0].trim()) {
                            // è§£ç cookieå€¼å¹¶è¿”å›
                            return decodeURIComponent(cookiePair[1]);
                        }
                    }
                    // å¦‚æœæœªæ‰¾åˆ°ï¼Œåˆ™è¿”å›null
                    return null;
                }

                const app = Vue.createApp({
                    data() {
                        return {
                            inprogress: false,
                            api_url: 'https://api.v5.zhelper.net',
                            language: {
                                changeapi: 'åˆ‡æ¢API',
                                home: 'è¿”å›é¦–é¡µ',
                                doc: 'æŸ¥çœ‹æ–‡æ¡£',
                                title: 'ä¹¦å',
                                author: 'ä½œè€…',
                                publisher: 'å‡ºç‰ˆç¤¾',
                                year: 'å‡ºç‰ˆæ—¶é—´',
                                filesize: 'æ–‡ä»¶å¤§å°',
                                extension: 'æ–‡ä»¶ç±»å‹',
                                source: 'ä¹¦æº',
                                info: 'ä¿¡æ¯'
                            },
                            apis: [
                                { name: 'zhelper V5', 'url': 'https://api.v5.zhelper.net' },
                                { name: 'zhelper V4', 'url': 'https://api.v4.zhelper.net' },
                                { name: 'ylibrary', 'url': 'https://api.ylibrary.org' }
                            ],
                            search_result: [],
                            detail: {},
                            keyword: '',
                            hits: 0,
                            page: 1,
                        }
                    },
                    methods: {
                        changeapi(url) {
                            this.api_url = url
                        },
                        search() {
                            this.page = 1;
                            this.inprogress = true;
                            axios.post(this.api_url + '/api/search/', {
                                keyword: this.keyword,
                                page: this.page,
                                sensitive: true
                            }).then(response => {

                                if (response.data.errorn) {
                                    alert(response.data.msg)
                                }
                                else {
                                    this.search_result = response.data.data
                                    this.hits = response.data.hits
                                }
                            }).catch(error => {
                                console.log(error)
                            })
                            this.inprogress = false;
                        },
                        change_page(change) {
                            this.page += change
                            axios.post(this.api_url + '/api/search/', {
                                keyword: this.keyword,
                                page: this.page
                            }).then(response => {
                                this.search_result = response.data.data
                            }).catch(error => {
                                console.log(error)
                            })
                        },
                        get_detail(id) {
                            axios.post(this.api_url + '/api/detail/', {
                                id: id
                            }).then(response => {
                                if (response.data.errorn) {
                                    alert(response.data.msg)
                                }
                                else {
                                    this.detail = response.data
                                }

                            }).catch(error => {
                                console.log(error)
                            })
                            var myModal = new bootstrap.Modal(document.getElementById('exampleModal'), {})
                            myModal.toggle()
                        },
                        filesizeToString(filesize) {
                            if (filesize > 0 && filesize < 1) {
                                return (filesize * 8).toFixed(2).toString() + 'b'
                            } else if (filesize <= 1024) {
                                return filesize.toFixed(2).toString() + 'B'
                            } else if (filesize <= Math.pow(1024, 2)) {
                                return (filesize / 1024).toFixed(2).toString() + 'KB'
                            } else if (filesize <= Math.pow(1024, 3)) {
                                return (filesize / Math.pow(1024, 2)).toFixed(2).toString() + 'MB'
                            }
                        }
                    },
                    computed: {
                        is_homepage() {
                            return location.path == '/'
                        },
                        total_page() {
                            return Math.floor(this.hits / 20) + 1
                        },
                    }
                })
                app.mount('#app')

            </script>
</body>

</html>